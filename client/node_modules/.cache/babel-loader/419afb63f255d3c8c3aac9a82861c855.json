{"ast":null,"code":"import _toConsumableArray from\"/Users/angelageorge/Desktop/DailyDiaryHub/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";import _slicedToArray from\"/Users/angelageorge/Desktop/DailyDiaryHub/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import React,{useEffect}from'react';import{useAuth0}from'@auth0/auth0-react';import LogoutButton from'./LogoutButton.js';import DiaryCards from'./DiaryCards.js';import NewEntry from'./NewEntry';import QuoteContainer from'./QuoteContainer';import SocialMedia from'./SocialMedia.js';import SearchBar from'./SearchBar';import axios from'axios';function Hub(){var _useAuth=useAuth0(),user=_useAuth.user,isAuthenticated=_useAuth.isAuthenticated;var mainContent={display:\"flex\",flexDirection:\"row\",alignItems:\"flex-start\"};var sidebar={display:\"flex\",flexDirection:\"column\",alignItems:\"center\"};var displayEntries={display:\"flex\",flexDirection:\"column\",alignItems:\"flex-start\"};var button={borderColor:\"transparent\",backgroundColor:\"white\",borderRadius:20,margin:5,paddingRight:10,paddingLeft:10};var _React$useState=React.useState([]),_React$useState2=_slicedToArray(_React$useState,2),displayArray=_React$useState2[0],setArray=_React$useState2[1];var _React$useState3=React.useState([]),_React$useState4=_slicedToArray(_React$useState3,2),searchArray=_React$useState4[0],setSearch=_React$useState4[1];var _React$useState5=React.useState(\"\"),_React$useState6=_slicedToArray(_React$useState5,2),newTitle=_React$useState6[0],setTitle=_React$useState6[1];var _React$useState7=React.useState(\"\"),_React$useState8=_slicedToArray(_React$useState7,2),newDate=_React$useState8[0],setDate=_React$useState8[1];var _React$useState9=React.useState(\"\"),_React$useState10=_slicedToArray(_React$useState9,2),newText=_React$useState10[0],setText=_React$useState10[1];var _React$useState11=React.useState(\"\"),_React$useState12=_slicedToArray(_React$useState11,2),newId=_React$useState12[0],setId=_React$useState12[1];function submitHandler(myNewEntry){var dbEntry={username:user.sub,//pass down username from auth0\ntitle:myNewEntry.title,text:myNewEntry.text,date:myNewEntry.date};if(newId!==\"\"){var id=newId;axios.post('https://'+document.location.hostname+'/entries/update/'+id,dbEntry).then(function(response){console.log(response.data);setId(\"\");setTitle(\"\");setDate(\"\");setText(\"\");loadProfile();}).catch(function(error){console.log(\"could not update\");});return;}//temp url!\naxios.post('https://'+document.location.hostname+'/entries/add',dbEntry).then(function(response){console.log(response.data);setArray([].concat(_toConsumableArray(displayArray),[myNewEntry]));setTitle(\"\");setDate(\"\");setText(\"\");loadProfile();}).catch(function(error){alert(\"You must enter a title, date, and text before you can submit a new entry.\");});}function changeHandler(editObject){if(editObject.change===\"delete\"){deleteEntry(editObject);}else{editEntry(editObject);}}function deleteEntry(editObject){var id=editObject.id;axios.delete('https://'+document.location.hostname+'/entries/'+id).then(function(res){console.log(res.data);loadProfile();});}function editEntry(editObject){setId(editObject.entry._id);setTitle(editObject.entry.title);setDate(editObject.entry.date.substring(0,10));setText(editObject.entry.text);}function updateValue(newValue){if(\"title\"in newValue){setTitle(newValue.title);}if(\"date\"in newValue){setDate(newValue.date);}if(\"text\"in newValue){setText(newValue.text);}}function searchHandler(keyword){if(keyword!==\"\"){setSearch(displayArray.filter(function(item,i){if(displayArray[i].text.includes(keyword)||displayArray[i].title.includes(keyword)){return item;}else return;}));}else{setSearch([]);}}var _React$useState13=React.useState(),_React$useState14=_slicedToArray(_React$useState13,2),main=_React$useState14[0],setHeader=_React$useState14[1];var _React$useState15=React.useState(),_React$useState16=_slicedToArray(_React$useState15,2),accent=_React$useState16[0],setSidebar=_React$useState16[1];var _React$useState17=React.useState([]),_React$useState18=_slicedToArray(_React$useState17,2),profile=_React$useState18[0],setProfile=_React$useState18[1];var _React$useState19=React.useState(false),_React$useState20=_slicedToArray(_React$useState19,2),isLoaded=_React$useState20[0],loaded=_React$useState20[1];var _React$useState21=React.useState(false),_React$useState22=_slicedToArray(_React$useState21,2),toggle=_React$useState22[0],toggleThis=_React$useState22[1];var headerColors=[\"pink\",\"CornflowerBlue\",\"DarkSeaGreen\"];var sideColors=[\"palevioletred\",\"aliceBlue\",\"SeaGreen\"];function loadProfile(){axios.get('https://'+document.location.hostname+'/users').then(function(response){console.log(response.data);if(response.data.length>0){var curUser=response.data.filter(function(obj){return obj.username===user.sub;});setProfile(curUser[0]);setHeader({backgroundColor:headerColors[profile.theme]});setSidebar({backgroundColor:sideColors[profile.theme]});loaded(true);}else{var dbUser={username:user.sub,theme:1};addUser(dbUser);}});// get entires from db\naxios.get('https://'+document.location.hostname+'entries').then(function(response){console.log(response.data);if(response.data.length>0){var entries=response.data.filter(function(obj){if(obj.username===user.sub){var entry={id:obj._id,username:obj.username,title:obj.title,text:obj.text,date:obj.date};return entry;}else return;});setArray(_toConsumableArray(entries));}else{setArray([].concat());}});}function addUser(dbUser){axios.post('https://'+document.location.hostname+'/users/add',dbUser).then(function(response){console.log(response.data);});setProfile(dbUser);loaded(true);}function cycleTheme(){var newIndex=profile.theme+1;if(newIndex>2){newIndex=0;}setProfile({_id:profile._id,username:profile.username,theme:newIndex});setHeader({backgroundColor:headerColors[newIndex]});setSidebar({backgroundColor:sideColors[newIndex]});var updateDB={username:profile.username,theme:newIndex};axios.post('https://'+document.location.hostname+'/users/update/'+profile._id,updateDB).then(function(res){return console.log(res.data);});}useEffect(function(){if(isAuthenticated){loadProfile();}},[isAuthenticated,isLoaded]);return isAuthenticated&&/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsxs(\"div\",{className:\"header\",style:main,children:[/*#__PURE__*/_jsx(\"h1\",{children:\"Daily Diary Hub\"}),/*#__PURE__*/_jsx(QuoteContainer,{id:user.sub}),/*#__PURE__*/_jsxs(\"div\",{className:\"navBttns\",children:[/*#__PURE__*/_jsx(\"img\",{src:user.picture,alt:user.name,className:\"profilePic\"}),/*#__PURE__*/_jsx(LogoutButton,{}),/*#__PURE__*/_jsx(\"button\",{style:button,onClick:cycleTheme,children:\"Change Theme\"})]})]}),/*#__PURE__*/_jsxs(\"div\",{style:mainContent,children:[/*#__PURE__*/_jsxs(\"div\",{style:(sidebar,accent),className:\"side-bar\",children:[/*#__PURE__*/_jsx(NewEntry,{title:newTitle,date:newDate,text:newText,id:newId,submitHandler:submitHandler,updateValue:updateValue}),/*#__PURE__*/_jsx(SocialMedia,{})]}),/*#__PURE__*/_jsxs(\"div\",{style:displayEntries,children:[/*#__PURE__*/_jsx(SearchBar,{searchHandler:searchHandler,value:\"\"}),/*#__PURE__*/_jsx(DiaryCards,{entries:searchArray.length>0?searchArray:displayArray,changeHandler:changeHandler})]})]})]});}export default Hub;","map":{"version":3,"sources":["/Users/angelageorge/Desktop/DailyDiaryHub/client/src/components/Hub.js"],"names":["React","useEffect","useAuth0","LogoutButton","DiaryCards","NewEntry","QuoteContainer","SocialMedia","SearchBar","axios","Hub","user","isAuthenticated","mainContent","display","flexDirection","alignItems","sidebar","displayEntries","button","borderColor","backgroundColor","borderRadius","margin","paddingRight","paddingLeft","useState","displayArray","setArray","searchArray","setSearch","newTitle","setTitle","newDate","setDate","newText","setText","newId","setId","submitHandler","myNewEntry","dbEntry","username","sub","title","text","date","id","post","document","location","hostname","then","response","console","log","data","loadProfile","catch","error","alert","changeHandler","editObject","change","deleteEntry","editEntry","delete","res","entry","_id","substring","updateValue","newValue","searchHandler","keyword","filter","item","i","includes","main","setHeader","accent","setSidebar","profile","setProfile","isLoaded","loaded","toggle","toggleThis","headerColors","sideColors","get","length","curUser","obj","theme","dbUser","addUser","entries","cycleTheme","newIndex","updateDB","picture","name"],"mappings":"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","sourcesContent":["import React, { useEffect } from 'react';\nimport { useAuth0 } from '@auth0/auth0-react';\nimport LogoutButton from './LogoutButton.js';\nimport DiaryCards from './DiaryCards.js';\nimport NewEntry from './NewEntry';\nimport QuoteContainer from './QuoteContainer'\nimport SocialMedia from './SocialMedia.js';\nimport SearchBar from './SearchBar'\nimport axios from 'axios';\n\n\nfunction Hub() {\n    const { user, isAuthenticated } = useAuth0();\n    const mainContent = {\n        display: \"flex\",\n        flexDirection: \"row\",\n        alignItems : \"flex-start\"\n    }\n\n    const sidebar = {\n        display: \"flex\",\n        flexDirection: \"column\",\n        alignItems: \"center\",\n    }\n\n    const displayEntries = {\n        display: \"flex\",\n        flexDirection: \"column\",\n        alignItems: \"flex-start\"\n    }\n\n      const button = {\n        borderColor : \"transparent\",\n        backgroundColor : \"white\",\n        borderRadius : 20,\n        margin : 5,\n        paddingRight: 10,\n        paddingLeft: 10\n    }\n\n    const [displayArray, setArray] = React.useState([]);\n    const [searchArray, setSearch] = React.useState([])\n    const [newTitle, setTitle] = React.useState(\"\");\n    const [newDate, setDate] = React.useState(\"\");\n    const [newText, setText] = React.useState(\"\");\n    const [newId, setId] = React.useState(\"\");\n\n    function submitHandler(myNewEntry) { \n        const dbEntry = {\n            username: user.sub, //pass down username from auth0\n            title: myNewEntry.title,\n            text: myNewEntry.text,\n            date:  myNewEntry.date\n        }\n\n        if (newId !== \"\")\n        {\n            let id = newId;\n            axios.post('https://' + document.location.hostname + '/entries/update/' + id, dbEntry)\n            .then((response) => {\n                console.log(response.data)\n                setId(\"\")\n                setTitle(\"\")\n                setDate(\"\")\n                setText(\"\")\n                loadProfile()\n            })\n            .catch((error) => {console.log(\"could not update\")})\n            return\n        }\n\n        //temp url!\n        axios.post('https://' + document.location.hostname + '/entries/add', dbEntry)\n            .then((response) => {\n                console.log(response.data)\n                setArray([...displayArray, myNewEntry])\n                setTitle(\"\")\n                setDate(\"\")\n                setText(\"\")\n                loadProfile()\n            })\n            .catch((error) => {\n                alert(\"You must enter a title, date, and text before you can submit a new entry.\")\n            })\n    }\n\n    function changeHandler(editObject){\n        if (editObject.change === \"delete\"){\n            deleteEntry(editObject)\n        }\n        else {\n            editEntry(editObject)\n        } \n    }\n\n    function deleteEntry(editObject) {\n        let id = editObject.id;\n        axios.delete('https://' + document.location.hostname + '/entries/' + id)\n            .then(res => {\n                console.log(res.data)\n                loadProfile()    \n            });\n    }   \n\n    function editEntry(editObject) {            \n        setId(editObject.entry._id)\n        setTitle(editObject.entry.title)\n        setDate(editObject.entry.date.substring(0,10))\n        setText(editObject.entry.text)\n    }\n\n    function updateValue(newValue){\n        if (\"title\" in newValue){\n            setTitle(newValue.title)\n        }\n        \n        if (\"date\" in newValue){\n            setDate(newValue.date)\n        }\n\n        if (\"text\" in newValue){\n            setText(newValue.text)\n        }\n        \n    }\n    \n    function searchHandler(keyword) {\n        if (keyword !== \"\"){\n            setSearch(displayArray.filter((item , i) => { \n                if (displayArray[i].text.includes(keyword) || displayArray[i].title.includes(keyword))\n                {\n                 return item \n                }\n                else return\n            }))\n        }\n        else {\n            setSearch([])\n        }\n    }\n\n    const [main, setHeader] = React.useState()\n    const [accent, setSidebar] = React.useState()\n    const [profile, setProfile] = React.useState([])\n    const [isLoaded, loaded] = React.useState(false)\n    const [toggle, toggleThis] = React.useState(false)\n\n    let headerColors = [\"pink\", \"CornflowerBlue\", \"DarkSeaGreen\"]\n    let sideColors = [\"palevioletred\", \"aliceBlue\", \"SeaGreen\"]\n\n    function loadProfile() {\n        axios.get('https://' + document.location.hostname + '/users')\n            .then(response=> {\n                console.log(response.data)\n                if (response.data.length > 0){\n                    let curUser = response.data.filter(function (obj){\n                        return obj.username === user.sub;\n                    });\n\n                    setProfile(curUser[0])\n                    setHeader({backgroundColor : headerColors[profile.theme]})\n                    setSidebar({backgroundColor : sideColors[profile.theme]})\n                    loaded(true)\n                }\n                else {\n                    const dbUser = {\n                        username: user.sub,\n                        theme: 1\n                    }\n                    addUser(dbUser)\n                }   \n            });\n        \n        // get entires from db\n        axios.get('https://' + document.location.hostname + 'entries')\n            .then(response=> {\n                console.log(response.data)\n                if (response.data.length > 0){\n                        let entries = response.data.filter( function(obj) {\n                            if (obj.username === user.sub){\n                                let entry = {\n                                    id : obj._id,\n                                    username : obj.username,\n                                    title : obj.title,\n                                    text: obj.text,\n                                    date: obj.date\n                                }\n                                return entry;\n                            }\n                            else return\n                    })\n                    setArray([...entries])    \n                }\n                else {\n                    setArray([...[]])\n                }\n            })\n\n    }  \n    \n    function addUser(dbUser) {\n        axios.post('https://' + document.location.hostname + '/users/add', dbUser)\n        .then((response) => {\n            console.log(response.data)\n        });\n\n        setProfile(dbUser)\n        loaded(true)\n    } \n\n    function cycleTheme(){\n        var newIndex = profile.theme+1;\n        if (newIndex > 2){\n            newIndex = 0\n        }\n\n        setProfile({\n            _id: profile._id,\n            username: profile.username,\n            theme: newIndex\n          });\n        setHeader({backgroundColor : headerColors[newIndex]})\n        setSidebar({backgroundColor : sideColors[newIndex]})\n        \n        let updateDB = {\n            username: profile.username,\n            theme: newIndex\n        }\n\n        axios.post('https://' + document.location.hostname + '/users/update/' + profile._id, updateDB)\n      .then(res => console.log(res.data));\n    }\n\n    useEffect(()=>{\n        if (isAuthenticated){\n        loadProfile()\n        }\n    }, [isAuthenticated, isLoaded]) \n    \n    return (\n        isAuthenticated && (\n            <div>\n                    \n                <div className = \"header\" style = {main}>\n                    <h1>Daily Diary Hub</h1>\n                    <QuoteContainer id = {user.sub}/>\n                    <div className = \"navBttns\">\n                        <img src = {user.picture} alt = {user.name} className = \"profilePic\"/>\n                        <LogoutButton />\n                        <button style = {button} onClick = {cycleTheme}>\n                            Change Theme\n                        </button>\n                    </div>\n                </div>\n                <div style = {mainContent}>\n                    \n                    <div style = {sidebar, accent} className = \"side-bar\">  \n                        <NewEntry title = {newTitle} date = {newDate} text = {newText} id = {newId} submitHandler = {submitHandler} updateValue = {updateValue}/>\n                        <SocialMedia />\n                    </div >\n                    <div style = {displayEntries}>\n                        <SearchBar searchHandler = {searchHandler} value = \"\"/>\n                        <DiaryCards entries = {searchArray.length > 0  ? searchArray : displayArray} changeHandler = {changeHandler} />\n                    </div>\n                    \n                </div>\n                \n            </div>\n        )\n    )\n}\n\nexport default Hub"]},"metadata":{},"sourceType":"module"}